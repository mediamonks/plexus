{
	"instructionsPath": "instructions/bosch",
	"vectordb": {
		"engine": "cloudsql"
	},
	"agents": {
		"sales-play-product-extractor": {
			"instructions": "You will receive a document representing a so-called sales play. Your task is to extract product data from this document as seen in the example under Output Format. Do not duplicate products, mention each product only once. Products should always have a unique SKU ID. The SKU ID should contain digits and letters only, no periods. You should also locate an image of the product. Do not assume or make up any data, do not copy the example values, only use the information found in the documents. If you are unsure about a field value, omit the field.",
			"outputTokens": 65535,
			"context": [
				"sales-plays"
			],
			"serialize": [ "sales-plays", "sales-play" ]
		},
		"sales-play-promotion-extractor": {
			"instructions": "You will receive a document representing a so-called sales play, alongside a list of products. Your task is to extract product promotion data from the documents, referencing the products from the product data, to populate the provided schema. Do not make up any data, or blindly copy the example values, only use the information found in the documents. If you are unsure about a field, omit it.",
			"outputTokens": 65535,
			"context": [
				"sales-plays",
				"product-data"
			],
			"serialize": [ "sales-plays", "sales-play" ]
		},
		"bosch-chatbot": {
			"context": [
				"userPrompt",
				"now"
			],
			"required": [
				"userPrompt",
				"now"
			],
			"dataSources": [
				"sales-data"
			]
		}
	},
	"catalog": {
		"divisions": {
			"type": "data",
			"dataSource": "divisions",
			"example": [
				{
					"division_name": "Some Division",
					"division_display_name": "Some Division Display Name",
					"division_code": "some division code",
					"division_id": 123
				}
			]
		},
		"customers": {
			"type": "data",
			"dataSource": "customers",
			"example": [
				{
					"customer_id": 123,
					"customer_name": "Some Customer",
					"postal_code": "AB1 2CD",
					"city": "LONDON"
				}
			]
		},
		"userPrompt": {
			"type": "input",
			"field": "prompt",
			"required": true,
			"example": "Based on the last 12 months of sales data for [Client Name], which 3 product categories showed the highest year-over-year growth, and which 3 categories underperformed their targets by more than 15%?"
		},
		"now": {
			"type": "input",
			"field": "now",
			"required": true,
			"example": "2025-12-31"
		},
		"response": {
			"type": "output",
			"agent": "bosch-chatbot",
			"field": "response",
			"example": "Your response to the user prompt goes here."
		},
		"sales-plays": {
			"type": "data",
			"dataSource": "sales-plays",
			"example": [
				"someFile.pdf",
				"someOtherFile.pdf"
			]
		},
		"sales-play": {
			"type": "data",
			"example": "someFile.pdf"
		},
		"product-data": {
			"type": "output",
			"agent": "sales-play-product-extractor",
			"field": "product-data",
			"example": [
				{
					"product_name": "Some Product",
					"sku_id": "0123456789",
					"retail_price": "123.45",
					"currency_code": "GBP",
					"discount_group": "some discount group code, e.g. B14",
					"included_products": [
						"skus of products included with this product",
						"0123456789",
						"0123456789",
						"0123456789"
					],
					"source": "filename of the document the product was found in, e.g. sales-play.pdf",
					"image_page": "the page number of the document the image of the product was found on, inside that same document, e.g. 1",
					"image_coordinates": "The bounding box of the product image in normalized coordinates (0-1). Must be in the order: [ymin, xmin, ymax, xmax]."
				}
			]
		},
		"promotion-data": {
			"type": "output",
			"agent": "sales-play-promotion-extractor",
			"field": "promotion-data",
			"example": [
				{
					"sku_id": "0123456789",
					"promotion_type": "discount",
					"promotion_unit": "% or GBP",
					"promotion_amount": 12,
					"start_date": "2025-12-31",
					"end_date": "2025-12-31",
					"condition": "whether any condition applies for the discount, e.g. Via Redemption Coupon",
					"source": "filename of the document the promotion was found in, e.g. sales-play.pdf"
				}
			]
		},
		"queries": {
			"type": "output",
			"agent": "query-generator",
			"example": [
				"WITH worst_performer AS (\n    SELECT \n        sku_id,\n        sku_desc,\n        gross_sales_lc\n    FROM \n        \"db-export-gemini-embedding-001\"\n    WHERE \n        division_display_name = 'Accessoires'\n        -- Updated to match format [quarter].[year]\n        AND period = 4.2025\n    ORDER BY \n        gross_sales_lc ASC\n    LIMIT 1\n)\nSELECT \n    t.sku_id,\n    t.sku_desc,\n    t.period,\n    SUM(t.gross_sales_lc) as total_gross_sales,\n    SUM(t.sales_qty) as total_sales_qty,\n    CASE WHEN t.period = 4.2025 THEN 'TARGET Q4' ELSE 'HISTORY' END as context\nFROM \n    \"db-export-gemini-embedding-001\" t\nINNER JOIN \n    worst_performer wp ON t.sku_id = wp.sku_id\nGROUP BY \n    t.sku_id, t.sku_desc, t.period\nORDER BY \n    t.period DESC;"
			],
			"_example": [
				{
					"table": "the name of the table",
					"input": "a term or string to perform a vector search for",
					"limit": "number of entries to return",
					"filter": {
						"fieldNameToFilterOn": "value to filter on",
						"anotherFieldNameToFilterOn": 123
					},
					"fields": [
						"fieldToReturn",
						"anotherFieldToReturn"
					]
				}
			]
		}
	},
	"data-sources": {
		"sales-plays": {
			"namespace": "bosch",
			"uri": "https://drive.google.com/drive/folders/1bOCx7wHlAO4LpkPHGT4kbZY8qassoU_h",
			"target": "file",
			"folder": true
		},
		"sales-data": {
			"namespace": "bosch-import",
			"uri": "gs://bosch-pt-sales-agent-data/data-export.jsonl",
			"target": "vector",
			"dataType": "data",
			"folder": false,
			"vectorFields": ["customer_name", "city", "sku_desc", "division_display_name"]
		},
		"divisions": {
			"namespace": "bosch-chat",
			"uri": "https://bosch-pt-sales-agent-6hsz3xbg.ew.gateway.dev/product-categories",
			"target": "vector",
			"dataType": "data",
			"vectorFields": ["division_display_name"]
		},
		"customers":{
			"namespace": "bosch-chat",
			"uri": "https://bosch-pt-sales-agent-6hsz3xbg.ew.gateway.dev/customers",
			"target": "vector",
			"dataType": "data",
			"vectorFields": ["customer_name"]
		},
		"promotions": {
			"namespace": "bosch-chat",
			"uri": "https://bosch-pt-sales-agent-6hsz3xbg.ew.gateway.dev/promotions",
			"target": "vector",
			"dataType": "data",
			"vectorFields": [],
			"collectionPath": "inactive"
		}
	},
	"output": [
		"response"
	]
}
